<!DOCTYPE html>
<html>

<head>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Movie recommendation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: Arial;
            background-color: #bacbe8;
        }
    </style>
</head>

<body>
    <h2 style="text-align: center">MOVIE RECOMMENDATION</h2>
    <p>Click on the tabbed menu:</p>

    <div class="tab">

        <button class="tablinks" onclick="openTab(event, 'Home')"><i class="fa fa-fw fa-home"></i>Home</button>
        <button class="tablinks" onclick="openTab(event, 'WatchedMovies')">Watched</button>
        <button class="tablinks" onclick="openTab(event, 'NeedToWatched')">Must-watch list</button>
        <button class="tablinks" onclick="openTab(event, 'LikedMovies')">Liked movies</button>
        <button class="tablinks" onclick="openTab(event, 'DislikedMovies')">Disliked movies</button>
        <button class="tablinks" onclick="openTab(event, 'Recommended')">Recommendation</button>
        <div class="search-container">
            <form>
                <input type="text" placeholder="Search.." name="search">
                <button type="submit"><i class="fa fa-search"></i></button>
            </form>
        </div>
    </div>

    <!–– table is used to display controls and text porperly ––>

    <div id="WatchedMovies" class="tabcontent">
        <table style="display:true" border="1">
            <tbody id="WatchedMoviesTable">
                <tr>
                    <td><b>Title</b></td>
                    <td><b>Ratings</b></td>
                    <td><b>Year</b></td>
                    <td><b>Genre</b></td>
                    <td><b>Language</b></td>
                    <td><b>Remove</b></td>
                    <td><b>Move</b></td>
                </tr>
            </tbody>
            <tr>
                <td><button onclick="addEntryToXML('WatchedMovies')">Add</button></td>
            </tr>
        </table>
    </div>
    <!–– end of WatchedMovies tab ––>

    <div id="NeedToWatched" class="tabcontent">
        <table style="display:true" border="1">
            <tbody id="NeedToWatchedTable">
                <tr>
                    <td><b>Title</b></td>
                    <td><b>Ratings</b></td>
                    <td><b>Year</b></td>
                    <td><b>Genre</b></td>
                    <td><b>Language</b></td>
                    <td><b>Remove</b></td>
                    <td><b>Move</b></td>
                </tr>
            </tbody>
            <tr>
                <td><button onclick="addEntryToXML( 'NeedToWatched')">Add</button></td>
            </tr>
        </table>
    </div>
    <!–– end of NeedToWatched tab ––>

    <div id="LikedMovies" class="tabcontent">
        <table style="display:true" border="1 ">
            <tbody id="LikedMoviesTable ">
                <tr>
                    <td><b>Title</b></td>
                    <td><b>Ratings</b></td>
                    <td><b>Year</b></td>
                    <td><b>Genre</b></td>
                    <td><b>Language</b></td>
                    <td><b>Remove</b></td>
                    <td><b>Move</b></td>
                </tr>
            </tbody>
            <tr>
                <td><button onclick="addEntryToXML( 'LikedMovies')">Add</button>
                </td>
            </tr>
        </table>
    </div>
    <!–– end of LikedMovies tab ––>

    <div id="DislikedMovies" class="tabcontent">
        <table style="display:true" border="1 ">
            <tbody id="DislikedMoviesTable ">
                <tr>
                    <td><b>Title</b></td>
                    <td><b>Ratings</b></td>
                    <td><b>Year</b></td>
                    <td><b>Genre</b></td>
                    <td><b>Language</b></td>
                    <td><b>Remove</b></td>
                    <td><b>Move</b></td>
                </tr>
            </tbody>
            <tr>
                <td>
                    <button onclick="addEntryToXML( 'DislikedMovies') ">Add</button>
                </td>
            </tr>
        </table>
    </div>
    <!–– end of DislikedMovies tab ––>

    <div id="Recommended" class="tabcontent">
        <table style="display:true" border="1 ">
            <tbody id="RecommendedTable ">
                <tr>
                    <td><b>Title</b></td>
                    <td><b>Ratings</b></td>
                    <td><b>Year</b></td>
                    <td><b>Genre</b></td>
                    <td><b>Language</b></td>
                    <td><b>Remove</b></td>
                    <td><b>Move</b></td>
                </tr>
            </tbody>
            <tr>
                <td><button onclick="addEntryToXML('Recommended')">Add</button></td>
            </tr>
        </table>
    </div>
    <!–– end of Recommended tab ––>


    <script>
        var counter = 1;
        //C:\Program Files (x86)\Google\Chrome\Application>.\chrome.exe --allow-file-access-from-files
        //python -m http.server
        //http://localhost:8000/MovieRecommendation.html
        function populateMovieListFromXML(xml, tabName) {
            var xmlDoc = xml.responseXML;
            var txt = "<tr><td><b>Title</b></td><td><b>Ratings</b></td><td><b>Year</b></td><td><b>Genre</b></td><td><b>Language</b></td>\
    <td><b>Remove</b></td><td><b>Move</b></td></tr>";
            path = "/User/MovieRecommendation/" + tabName + "/Movie";
            console.log(path);
            if (xmlDoc.evaluate) {
                var nodes = xmlDoc.evaluate(path, xmlDoc, null, XPathResult.ANY_TYPE, null);
                //console.log(nodes.length);
                //console.log(nodes);
                //--------------------------
                //var x = xmlDoc.getElementsByTagName("title");
                //console.log("getElementsByTagName"+ x[0].childNodes[0].nodeValue);
                //----------------------------------
                var result = nodes.iterateNext();
                var elem;
                var genre;
                var title;
                var ratings;
                var year;
                var lang;
                while (result) {
                    genre = result.getAttribute('genre');
                    title = result.getElementsByTagName("title")[0].childNodes[0].nodeValue;
                    ratings = result.getElementsByTagName("ratings")[0].childNodes[0].nodeValue;
                    year = result.getElementsByTagName("year")[0].childNodes[0].nodeValue;
                    lang = result.getElementsByTagName("title")[0].getAttribute('lang');

                    console.log("result innerHTML" + result.innerHTML);
                    console.log('genre=' + genre);
                    console.log("title=" + title);
                    console.log("ratings=" + ratings);
                    console.log("year=" + year);
                    console.log("lang=" + lang);

                    txt += "<tr><td>" + title + "</td><td>" + ratings + "</td><td>" + year +
                        "</td><td>" + genre + "</td><td>" + lang + "</td><td><button onclick='removeEntryfromXML(" + tabName +
                        ")'>Remove</button></td><td><button onclick='moveEntryfromXML(" + tabName +
                        ")'>Move</button></td></tr>";

                    result = nodes.iterateNext();
                }
                console.log(txt);
                //WatchedMoviesTable
                var completeTable = document.getElementById(tabName + "Table");

                completeTable.innerHTML = txt;
            }
        }

        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
            //-----------------------------------------------------------
            if (tabName != "Home") {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        populateMovieListFromXML(this, tabName);
                    }
                };
                xhttp.open("GET", "MovieRecommendation.xml", true);
                xhttp.send();
            }

            //populateMovieListFromXML(tabName);
            //-----------------------------------------------------------
        }
    </script>

</body>

</html>